<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>AI Prediksi Minyak</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>

<style>
body { margin:0; font-family: Arial; }
#map { height: 100vh; }
.panel {
 position:absolute; top:10px; left:10px;
 background:#fff; padding:10px;
 border-radius:8px; width:280px;
 box-shadow:0 0 10px rgba(0,0,0,.3);
 z-index:999;
}
button { width:100%; margin-bottom:6px; }
</style>
</head>

<body>

<div class="panel">
  <h3>AI Prediksi Minyak</h3>
  <button onclick="getGPS()">Aktifkan GPS</button>
  <button onclick="analyze()">Analisis AI</button>

  <div id="info"></div>
</div>

<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
let map = L.map('map').setView([-3,104],7);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

let marker, lat, lon;

function getGPS(){
 navigator.geolocation.getCurrentPosition(pos=>{
   lat = pos.coords.latitude;
   lon = pos.coords.longitude;

   if(marker) map.removeLayer(marker);
   marker = L.marker([lat,lon]).addTo(map)
     .bindPopup(`Lat:${lat}<br>Lon:${lon}`).openPopup();
   map.setView([lat,lon],12);
 });
}

async function analyze(){
 if(!lat){ alert('Aktifkan GPS dulu'); return; }

 const res = await fetch(
   'https://oil-ai.onrender.com/analyze',
   {
     method:'POST',
     headers:{'Content-Type':'application/json'},
     body:JSON.stringify({lat, lon})
   }
 );

 const data = await res.json();
 document.getElementById('info').innerHTML = `
   <b>Jarak Patahan:</b> ${data.jarak_patahan_km} km<br>
   <b>Kedalaman:</b> ${data.kedalaman_m} m<br>
   <b>Antiklin:</b> ${data.antiklin}<br>
   <b>Dalam Cekungan:</b> ${data.dalam_cekungan}<br>
   <b>Potensi:</b> ${data.potensi_minyak}%<br>
   <b>Status:</b> ${data.status}
 `;
}
</script>

</body>
</html>